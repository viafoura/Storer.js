/*! Storer.js
 * @copyright Viafoura, Inc. <viafoura.com>
 * @author Shahyar G <github.com/shahyar>, originally for <github.com/viafoura>
 * @license CC-BY 3.0 <creativecommons.org/licenses/by/3.0>: Keep @copyright, @author intact.
 */function initStorer(a,b){"use strict";function c(a,b,c,d){return null===b||void 0===b||a&&parseInt(+new Date/1e3,10)>parseInt(a,10)?(c(d),null):void 0!==b._end?b.value:b}function d(a,b,d){try{var e=a&&JSON.parse(a);if(e&&void 0!==e._end)return c(e._end,e.value,b,d)}catch(f){}return a}function e(a,b,c,d,e,f){var g=parseInt(+new Date/1e3,10);switch(typeof b){case"number":b=b&&parseInt(g+b,10);break;case"string":b=b.length>4&&""+parseInt(b,10)===b?parseInt(b,10):parseInt(+new Date(b)/1e3,10);break;case"object":b.toGMTString&&(b=parseInt(+b/1e3,10));break;default:b=null}return a={value:b&&g>b?null:a,_end:b||null},null===a.value||void 0===a.value?d&&d(e):f?c&&c(e,JSON.stringify(a._end?a:a.value)):c&&c(e,a._end?a:a.value),a}function f(){var a,b,c;for(a in x)if(x.hasOwnProperty(a)&&"_"!==a.charAt(0)&&"memoryStorage"!==x[a].STORE_TYPE)for(b=0;c=x[a].key(b++);)x[a].getItem(c)}function g(a,b){var c={STORE_TYPE:"ref"+a,key:function(a){return b.key(a)},getItem:function(a){return b.getItem(a)},setItem:function(a,c,d){return b.setItem(a,c,d)},removeItem:function(a){return b.removeItem(a)},clear:function(){return b.clear()}};return Object.defineProperty(c,"length",{get:function(){return b.length}}),c}function h(a,b){var c=document.createElement("div");return c.STORE_TYPE="DOM"+a,c.key=b.key,c.getItem=b.getItem,c.setItem=b.setItem,c.removeItem=b.removeItem,c.clear=b.clear,Object.defineProperty(c,"length",{get:function(){return b.length}}),c}function i(a){var b=a.getItem,c=a.setItem,f=a._removeItem||a.removeItem,g=function(a){f(a)};return a.getItem=function(a){return d(b(a),g,a)},a.setItem=function(a,b,d){return e(b,d,function(a,b){c(a,b)},g,a,!0)},a}function j(a){return t&&"memoryStorage"!==a.STORE_TYPE?(a._getItem=a.getItem,a._setItem=a.setItem,a._removeItem=a.removeItem,a._key=a.key,a.getItem=function(b){return a._getItem(t+b)},a.setItem=function(b,c,d){return a._setItem(t+b,c,d)},a.removeItem=function(b){return a._removeItem(t+b)},a._key=a.key,a.key=function(b){return void 0!==(b=a._key(b))&&null!==b?0===b.indexOf(t)?b.substr(t.length):b:null},"cookieStorage"!==a.STORE_TYPE?a.clear=function(){for(var b,c=a.length;c--;)0===(b=a._key(c)).indexOf(t)&&a._removeItem(b)}:a.hasItem&&(a._hasItem=a.hasItem,a.hasItem=function(b){return a._hasItem(t+b)}),a):a}function k(a){function c(){k.length=k.getAll().length}a=a||"";var d=new RegExp("(?:^|;)\\s*"+a+t+"[^=;]+\\s*(?:=[^;]*)?","g"),f=new RegExp("^;?\\s*"+a+t),g=new RegExp("(?:^|;)\\s*[^=;]+\\s*(?:=[^;]*)?","g"),h=new RegExp("^;?\\s*"),i=new Date(1979).toGMTString(),k={STORE_TYPE:"cookieStorage",DEFAULT_DOMAIN:escape(b.default_domain||""),DEFAULT_PATH:escape(b.default_path||""),length:0,key:function(a,b){var c=this.getAll(!1,b);return c[a]?c[a].key:void 0},clear:function(a){for(var b=this.getAll(!1,a),c=b.length;c--;)this.removeItem(b[c].key)},getAll:function(a,b){var c,e=b?h:f,i=document.cookie.match(b?g:d)||[],j=i.length;if(a===!0)for(c={length:j};j--;)c[unescape((i[j]=i[j].split("="))[0].replace(e,""))]=i[j][1];else for(c=[];j--;)c.push({key:unescape((i[j]=i[j].split("="))[0].replace(e,"")),value:i[j][1]});return c},getItem:function(b,c){return b&&n(b,c)?(c=document.cookie.match(new RegExp("(?:^|;) *"+escape((c?"":a)+b)+"=([^;]*)(?:;|$)")),c&&c[0]?unescape(c[1]):null):null},setItem:function(b,d,f,g,h,i,j){if(!b||"expires"===b||"max-age"===b||"path"===b||"domain"===b||"secure"===b)return!1;var l="",n=e(d,f);return null!==n._end&&(l="; expires="+new Date(1e3*n._end).toGMTString()),null!==n.value&&void 0!==d&&null!==d?(h=(h="string"==typeof h?escape(h):k.DEFAULT_DOMAIN)?"; domain="+h:"",g=(g="string"==typeof g?escape(g):k.DEFAULT_PATH)?"; path="+g:"",document.cookie=escape((j?"":a)+b)+"="+escape(d)+l+h+g+(i?"; secure":""),c(),!0):m(b,h,g,i,j)},removeItem:function(b,d,e,f,g){b&&n(b,g)&&(d=(d="string"==typeof d?escape(d):k.DEFAULT_DOMAIN)?"; domain="+d:"",e=(e="string"==typeof e?escape(e):k.DEFAULT_PATH)?"; path="+e:"",document.cookie=escape((g?"":a)+b)+"=; expires="+i+d+e+(f?"; secure":""),c())},hasItem:function(b,c){return new RegExp("(?:^|;) *"+escape((c?"":a)+b)+"=").test(document.cookie)}},m=k.removeItem,n=k.hasItem;return k.setItem(r,4),4==k.getItem(r)?(k.removeItem(r),j(k)):l()}function l(){var a={},b=[],d={},f={STORE_TYPE:"memoryStorage",length:0,key:function(a){return b[a]},getItem:function(b){return c(a[b]&&a[b]._end,a[b],this.removeItem,b)},setItem:function(c,g,h){return null!==g&&void 0!==g?(void 0===d[c]&&(d[c]=(f.length=b.push(c))-1),(a[c]=e(g,h)).value):f.removeItem(c)},removeItem:function(c){var e=void 0!==a[c];if(void 0!==d[c]){for(var g=b.length;--g>d[c];)d[b[g]]--;b.splice(d[c],1),delete d[c]}return delete a[c],f.length=b.length,e},clear:function(){for(var c in a)a.hasOwnProperty(c)&&delete a[c];f.length=b.length=0,d={}}};return f}function m(a){function b(){var b=a.name,c=b.indexOf(l),d=b.indexOf(m),e=y.length;for(c>-1&&d>c&&(a.name=b.slice(0,c)+b.slice(d+u)),b="";e--;)x[y[e]]&&x[y[e]].value&&(b+=o+(""+y[e]).length+":"+(""+x[y[e]].value).length+p+y[e]+p+x[y[e]].value+q);a.name+=l+encodeURI(g.encode(f,b))+m}function d(){var c=a.name,d=c.indexOf(l),e=c.indexOf(m),h=0,i="",j=0,k=0;if(d>-1&&e>d)for(a.name=c.slice(0,d)+c.slice(e+u),c=g.decode(f,decodeURI(c.slice(d+t,e)));-1!==(d=c.indexOf(o,h));)h=d+v,-1!==(e=c.indexOf(p,h))&&(j=c.slice(h,e).split(":"),k=parseInt(j[1],10),j=parseInt(j[0],10),h=e+w,(e=c.indexOf(p,h))===h+j&&(i=c.substr(h,j),h=e+w,(e=c.indexOf(q,h))===h+k&&z.setItem(i,c.substr(h,k))));a.addEventListener?a.addEventListener("beforeunload",b,!0):a.attachEvent&&a.attachEvent("onbeforeunload",b)}a||(a=s);var f,g=function(a,b,c){return{decode:function(a,b){return this.encode(a,b)},encode:function(c,d){for(var e,f=c.length,g=d.length,h=[],i=[],j=0,k=0,l=0,m=0;256>j;j++)i[j]=j;for(j=0;256>j;j++)k=(k+(e=i[j])+c.charCodeAt(j%f))%256,i[j]=i[k],i[k]=e;for(k=0;g>l;l++)j=l%256,k=(k+(e=i[j]))%256,f=i[j]=i[k],i[k]=e,h[m++]=d.charCodeAt(l)^i[(f+e)%256];return b.apply(a,h)},key:function(d){for(var e=0,f=[];d>e;e++)f[e]=1+(255*c()<<0);return b.apply(a,f)}}}(String,String.fromCharCode,Math.random),h="[object Opera]"===Object.prototype.toString.call(window.opera);try{f=decodeURI(n.getItem(".sessionStorageKey"))}catch(i){}f&&f.length===r||(f=g.key(r),n.setItem(".sessionStorageKey",encodeURI(f)));var j=a.document.domain,k=g.encode(f,j),l="#"+String.fromCharCode(1)+"STOR/"+k,m=k+"/STOR"+String.fromCharCode(4)+"#",o=String.fromCharCode(2)+";",p=String.fromCharCode(23)+";",q=";"+String.fromCharCode(3),r=32,t=l.length,u=m.length,v=o.length,w=p.length,x=(q.length,{}),y=[],z={STORE_TYPE:"name",length:0,key:function(a){return y[a]},getItem:function(a){return c(x[a]&&x[a]._end,x[a],A,a)},setItem:function(a,c,d){var f=e(c,d)._end;return null===f.value?A(a):(x[a]?(x[a].value=c,x[a]._end=f._end):x[a]={value:c,index:(z.length=y.push(a))-1,_end:f._end},f._end||delete x[a]._end,h&&b(),c)},removeItem:function(a){if(x[a]){if(y[x[a].index]===a){y.splice(x[a].index,1),z.length=y.length;for(var c=x[a].index,d=y.length;d>c;c++)x[y[c]].index--}return delete x[a],h&&b(),!0}return!1},clear:function(){y.length=0,x={},h&&b()}},A=z.removeItem;try{d()}catch(i){}return z}var n,o,p,q,r="__SG__",s=window,t=(b="[object Object]"===Object.prototype.toString.call(a)?a:b||{}).prefix||"",u=b.no_cookie_fallback||!1,v=!0;b===a&&(a=null);try{for(;s!==s.top;)s=s.top}catch(w){}a&&(a=function(a){return function(){a(x),setTimeout(f,100)}}(a));var x={cookieStorage:null,localStorage:null,memoryStorage:null,sessionStorage:null,_createCookieStorage:k,_createMemoryStorage:l};return x.cookieStorage=n=k(),x.memoryStorage=p=l(),x.sessionStorage=q=function(){var a=s.sessionStorage;if(a)try{a.setItem(r,1),a.removeItem(r);var b=function(){};b.prototype=a,b=new b;try{b.getItem&&(b.setItem(r,2),b.removeItem(r))}catch(c){b=null}a=i(b&&!b.getItem?h("sessionStorage",a):b&&"[object StoragePrototype]"!==Object.prototype.toString.apply(Storage.prototype)?b:g("sessionStorage",a))}catch(c){a=null}if(!a){try{a=m(),a.setItem(r,2),2==a.getItem(r)?a.removeItem(r):a=null}catch(c){a=null}a||(a=l())}return"cookieStorage"===a.STORE_TYPE?a:j(a)}(),x.localStorage=o=function(){var b;if(s.localStorage||s.globalStorage)try{b=s.localStorage||s.globalStorage[location.hostname],b.setItem(r,1),b.removeItem(r);var d=function(){};d.prototype=b,d=new d;try{d.getItem&&(d.setItem(r,2),d.removeItem(r))}catch(f){d=null}b=i(d&&!d.getItem?h("localStorage",b):d&&"[object StoragePrototype]"!==Object.prototype.toString.apply(Storage.prototype)?d:g("localStorage",b))}catch(f){b=null}return b||(b=function(){var d=function(a){return"PS"+a.replace(f,"__").replace(g,"_s")},f=/_/g,g=/ /g,h=d(t+"uData"),i=d("Storer");if(window.ActiveXObject)try{var j={},m=[],n={},p={STORE_TYPE:"userData",length:0,key:function(a){return m[a]},getItem:function(a){var b=d(a);return c(s.getAttribute("_end_"+b),s.getAttribute(b),q,a)},setItem:function(a,b,c){if(null!==b&&void 0!==b){var f=d(a),g=e(b,c);if(null!==g.value)return s.setAttribute(f,b),g._end?s.setAttribute("_end_"+f,""+g._end):s.removeAttribute("_end_"+f),void 0===n[a]&&(n[a]=(p.length=m.push(a))-1),s.save(h+i),j[a]=g.value}return q(a)},removeItem:function(a){var b=d(a);if(s.removeAttribute(b),s.removeAttribute("_end_"+b),void 0!==n[a]){for(var c=m.length;--c>n[a];)n[m[c]]--;m.splice(n[a],1),delete n[a]}s.save(h+i),p.length=m.length},clear:function(){for(var a,b=s.xmlDocument,c=b.firstChild.attributes,d=c.length;0<=--d;)a=c[d],delete j[a.nodeName],s.removeAttribute(a.nodeName),p.length--;s.save(h+i),p.length=m.length=0,j={},n={}}},q=p.removeItem,s=(p.hasItem,document.createElement("input"));s.style.display="none",s.addBehavior("#default#userData");var w="function"==typeof domReady?domReady:"undefined"!=typeof jQuery?jQuery(document).ready:!1;return v=!w,w&&w(function(){try{var c=document.body||document.getElementsByTagName("head")[0];if(c.appendChild(s),s.load(h+i),p.setItem(r,3),3==p.getItem(r)){p.removeItem(r);for(var d,e=s.xmlDocument,f=e.firstChild.attributes,g=-1,q=f.length;++g<q;)d=f[g],void 0!==d.nodeValue&&null!==d.nodeValue&&(n[d.nodeName]=m.push(d.nodeName)-1,j[d.nodeName]=d.nodeValue);x.localStorage=o=p,a&&a(x)}else p=null}catch(t){p=null}p||(x.localStorage=o=b=u?l():k("localStorage"),a&&a(x))}),p}catch(y){}}()),b||(b=u?l():k("localStorage")),"cookieStorage"===b.STORE_TYPE?b:j(b)}(),v&&a&&a(x),x}window.initStorer=initStorer;